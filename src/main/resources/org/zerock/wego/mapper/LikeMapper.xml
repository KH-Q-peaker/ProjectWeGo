<?xml version="1.0" encoding="UTF-8"?>



<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.zerock.wego.mapper.LikeMapper">
	
	<select id="selectLikeCountByTarget"
			resultType="Integer">
	
		SELECT
			COUNT(user_id)
		FROM
			like_tb
		<where>
			target_gb = #{targetGb}
		AND
			target_cd = #{targetCd}
		</where>
	</select>


	<select id="selectLikedTargetByUserId">
		
		SELECT
			1
		FROM
			dual
		WHERE EXISTS(
			SELECT 1
			FROM like_tb
			WHERE user_id = #{userId}
			AND target_cd = #{cri.targetCd}
			AND target_gb = #{cri.targetGb}
		)
	</select>
	
	
	<insert id="insertLike">
		
		INSERT INTO like_tb
			(target_gb, target_cd, user_id)
		VALUES
			(#{cri.targetGb},
			 #{cri.targetCd}, 
			 #{userId})
		
	</insert>
	
	<delete id="deleteLike">
		
		DELETE
		FROM
			like_tb
		WHERE
			target_gb = #{cri.targetGb}
		AND
			target_cd = #{cri.targetCd}
		AND
			user_id = #{userId}
		
	</delete>
</mapper>